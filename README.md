
# 🔐 Encrypted Transfer System (端到端加密传输系统)

一个基于 **零知识证明（Zero-Knowledge）** 架构的极简隐私信息传输平台。
集成了“**阅后即焚私密笔记**”、“**临时加密会话**”与“**公开聊天大厅**”三大核心功能。

本项目采用 **端到端加密 (E2EE)** 技术，所有数据加密解密均在用户浏览器端完成（AES-GCM 256位），服务器仅负责存储密文。这意味着**即便是服务器管理员，也无法窥探您的任何内容**。

---

## ✨ 核心特性 (Key Features)

### 🛡️ 极致安全 (Security First)
* **端到端加密**：利用 Web Crypto API 在本地加密。发送给服务器的只有乱码，密钥包含在 URL Hash 中，服务器永远不可见。
* **零信任渲染**：图片和视频链接默认不自动加载，显示为“点击加载”按钮，彻底杜绝 IP 泄露和 CSRF 攻击。
* **防 XSS 注入**：严格的输入清洗和链接过滤机制，防止恶意代码执行。

### 💬 双模式实时聊天 (Dual-Mode Chat)
1.  **临时私聊 (Ephemeral Mode)**：
    * 一键建房，链接即密钥。
    * **心跳机制**：房主在线即存活。一旦房主关闭页面或点击退出，房间及记录立即物理销毁。
    * **防爆破**：同 IP 每 60 秒限建一个房间。
2.  **公开大厅 (Public Lobby)**：
    * 管理员（持有口令）可创建长期存在的公开房间。
    * 访客需输入**进房密码**才能解密内容。
    * 支持管理员一键删除房间。

### 📝 私密笔记 (Secure Notes)
* **灵活销毁**：支持“阅后即焚”（阅读一次即删）或“限时销毁”。
* **密码保护**：可选设置访问密码，为您的秘密加第二道锁。
* **自动过期**：支持设置 1小时 / 24小时后自动物理删除。

### ⚔️ 服务器防御体系 (Server Defense)
* **资源保护**：
    * **防僵尸数据**：自动清道夫机制，定时清理过期笔记和无人互动的死房间。
    * **防内存溢出**：自动清理内存中的限流记录。
    * **防数据库虚胖**：开启 SQLite `WAL` 模式 + `auto_vacuum`，删除数据后立即释放磁盘空间。
* **流量控制**：
    * **全局限流**：每人每秒限发 1 条消息。
    * **包体限制**：全局限制请求体最大 100KB，单条消息限制 20KB（约 6000 汉字），防止垃圾数据撑爆硬盘。

---

## 🚀 快速部署 (Deployment)

本项目专为 Docker 环境设计，支持一键部署至 Leaflow, Sealos, Zeabur 或任意 VPS。

### 🐳 使用 Docker (推荐)

```bash
# 1. 拉取并运行
# 请将 <your-image-name> 替换为你构建的镜像名称
# ADMIN_PASSWORD 用于创建公开大厅房间，请务必修改！

docker run -d \
  -p 8787:8787 \
  -e ADMIN_PASSWORD="SetYourComplexPasswordHere" \
  --name secure-transfer \
  <your-image-name>
````

启动后，访问 `http://localhost:8787` (或你的域名) 即可使用。

### 🔧 环境变量 (Environment Variables)

| 变量名 | 默认值 | 说明 |
| :--- | :--- | :--- |
| `PORT` | `8787` | 应用监听端口 |
| `ADMIN_PASSWORD` | `admin888` | **重要**：管理员口令，用于在公开大厅创建或删除房间 |

-----

## 📖 使用指南

### 1\. 发送私密笔记

1.  输入敏感信息（如密码、API Key）。
2.  (可选) 设置销毁时间或访问密码。
3.  点击生成，**复制生成的链接**发送给对方。

### 2\. 发起聊天

  * **临时私聊**：
      * 点击首页“临时私聊”，将浏览器地址栏链接发给好友。
      * *注意：作为房主，请保持页面开启。您退出后房间将销毁。*
  * **公开大厅**：
      * 点击“创建公开房间”（需输入管理员口令）。
      * 设置房间名和**进房密码**。
      * 访客在列表中点击“加入”，输入密码即可解密聊天。
  * **发送文件/图片**：
      * 点击输入框左侧的 `📂` 按钮，上传文件后将链接粘贴到输入框发送。
      * 接收方点击气泡中的按钮即可加载查看（保护隐私）。

-----

## 🛠️ 技术栈

  * **Backend**: Python 3 (Flask)
  * **Database**: SQLite3 (WAL Mode + Auto Vacuum)
  * **Frontend**: HTML5 / CSS3 / Vanilla JS (No Frameworks)
  * **Encryption**: Web Crypto API (AES-GCM)

## ⚠️ 安全免责声明

本项目采用行业标准的加密算法（AES-GCM + PBKDF2），旨在提供比传统即时通讯软件更高的隐私保护。

**使用前请注意：**

1.  **必须使用 HTTPS**：Web Crypto API 在非 HTTPS 环境下可能无法工作，且存在中间人攻击风险。
2.  **链接即密钥**：对于临时房间和无密码笔记，链接本身包含了解密密钥，请通过安全渠道发送。
3.  **环境安全**：请确保您的设备未中木马。

*作者不对因使用本软件产生的任何数据丢失或泄露承担责任。*

## License



GPL-3.0 license.

```
